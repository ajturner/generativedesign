<!DOCTYPE html>
<html>
<head>
	<title>Explorations of Visualizations</title>
	<style>
	body {
		background-color: white;
		color: black;
	}
    #area {
    	border: 1px solid #444;
    	height: 600px;
    	width: 600px
    }
	</style>
	<script src="//d3js.org/d3.v3.min.js" charset="utf-8"></script>
</head>
<body>
<h1>Generative Design</h1>
<h2>P2.1.2: Movement in a Grid</h2>

<p>Line Caps - 1: Round, 2: Square, 3: Butt</p>
<script type="text/javascript">
var fillOverlap = 20;
var fillOpacity = 0.6;
var runPercent = 0.7;
var skipPercent = 0.4;

var height = 600;
var width = 600;
var hueValues = [];
var saturationValues = [];
var luminanceValues = [];
var resolutionX = 10, resolutionY = 10;
var tileCount = height/resolutionY * width/resolutionX;
var lineCap = "square"
var svg = d3
	.select("body")
	.append("svg")
	.attr("id","area")

var jitterScale = d3.scale.linear()
    .domain([0,1])
    .range([-resolutionX/2,resolutionX/2]);
var jitterFactor = d3.scale.linear()
    .domain([0,width])
    .range([0,1]);

function clear() {
	svg.selectAll("*").remove();
}
function draw(coordinates) {
	clear();
	for(var gridY=0; gridY<height; gridY += resolutionY){
		for(var gridX=0; gridX<width; gridX += resolutionX){
			var posX = width/tileCount*gridX
			var posY = height/tileCount*gridY

			var stroke = coordinates[1] / 60;
			var shiftX = jitterScale(Math.random()*jitterFactor(coordinates[0]));
			var shiftY = jitterScale(Math.random()*jitterFactor(coordinates[0]));

			svg.append("line")
				.attr("x1", gridX + resolutionX/2)
				.attr("y1", gridY + resolutionY/2)
				.attr("x2", gridX + resolutionX/2 + shiftX)
				.attr("y2", gridY + resolutionY/2 + shiftY)
				.attr("stroke", "#BBBBBB")
				.attr("stroke-width", 2)

			svg.append("circle")
				.attr("cx", gridX + resolutionX/2 + shiftX)
				.attr("cy", gridY + resolutionY/2 + shiftY)
				.attr("r", resolutionX / 5)
				.attr("fill", "white")
				.attr("stroke-width", stroke)
				.attr("stroke","red")
				.attr("fill-opacity",0)
		}
	}
}

svg.on('mousemove', function () {
	var coordinates = [0, 0];
	coordinates = d3.mouse(this);
	draw(coordinates);
});
d3.select("body")
    .on("keydown", function() {
    	switch(d3.event.keyCode) {
    		case 49:
    			lineCap = "round";
    			break;
    		case 50:
    			lineCap = "square";
    			break;	
    		case 51:
    			lineCap = "butt";
    			break;	    			
    	}
    });

</script>
<br/><a href="/">home</a>
</body>
</html>